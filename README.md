# 小鹤音形大字库扩展

小鹤音形输入法官方对生僻字支持有限，本项目旨在提供更好的生僻字输入体验。

## 使用方法
使用[深蓝词库转换](https://github.com/studyzy/imewlconverter)或其他程序转换为你需要的格式，然后导入你的输入法中。

## 开发历程
注意到痛点后，我们在网络上搜索了[汉字拆分库](https://github.com/kfcd/chaizi)，并通过递归拆分、细化字根的方式得到了数据库中绝对多数汉字各部件的小鹤形码，然后辅以[汉语拼音数据库](https://github.com/mozillazg/pinyin-data)得到了最终的小鹤音形码。

## 文件架构
### xhe_final_yinxing.txt
最终文件，穷举了一万多个汉字所有可能的拆分方式与读音的结合，共计 24077 条编码。建议搭配小鹤官方码表使用。
格式：
```
汉字[Tab]编码
```
样例：
```
丅	xxal
㐆	ybpv
㐆	yipv
㐬	lqwv
㓁	whbb
㔾	jpvv
㝵	deoc
㡀	bidd
丐	gdxb
丐	gdvp
丣	yzaa
並	bkby
丱	grvl
丱	klvl
乁	yiad
乁	jiad
乾	qmuq
乾	gjuq
仝	tsrg
佇	zurd
```
（注：似乎是由于拆分库中混入了部分繁体字，我们的编码文件中也存在部分繁体字，输入逻辑仍然是直接对字形拆分后取字根。）

### parts.txt
参照小鹤音形官网（截至发稿，官网为[flypy.cc](flypy.cc)）制作的字根表，对部分字根的字形作了细化处理，以包含拆分库中尽可能多的汉字部件。
格式：
```
字母[Space]字根1[Space]字根2[Space]……
```
样例：
```
a 一 鱼 凹
b 冖 宀 丷 疒 勹 百 白 八 卜 匕 卞 不 巴 本 必 丙 半 办
c 艹 廾 寸 才 匆 册
d 丶 冫 氵 刂 ⺈ 大 丁 刀 歹 刁 东 丹 电 氐
```
（注：由于此处并不体现二者区别，我们将小鹤音形官方概念中的 `字根` 和 `小字` 统称为 `字根`。）

**重要：码表中存在三个多字符字根，这是由于它们本身不在 Unicode 码表中，无法直接表达。它们是“余”除人字头以外的部分（`余下`）、“具”除去底部两点外的部分（`具上`）和“其”除去底部两点外的部分（`其上`）。二次开发时请务必注意。**
*（拆分库中将这些字根进一步拆分为“于 + 八”、“目 + 一”、“甘 + 一”，我们将这些部件连续出现处全部替换为了“余下”“具上”和“其上”。）*

### chaizi-jt-ext.txt
为了使递归拆字正常进行，我们对拆字库 `chaizi-jt.txt` 进行的必要增补。

### generator.py
依据字根表、拆分库生成形码表的脚本，由 ChatGPT 编写，我们进行了极微量修改。

### transferer.py
依据形码表、拼音库生成最终音形码表的脚本，由 ChatGPT 编写，我们进行了极微量修改。
注：由于本人记错了小鹤音形对两位长度复韵母的零声母汉字处理方式，此处采用了另一种零声母处理：
对于形如 `a` 的单韵母，重复之；
对于形如 `ai`、`ang` 的复韵母，输入其开头和键位，如 `ai` -> `ad`。
